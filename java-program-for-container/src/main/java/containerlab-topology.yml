name: containerlab-topology
prefix: p2p

mgmt:
  network: fixedips
  ipv4-subnet: 172.100.100.0/24
topology:
  nodes:
    trackerPeer:
      kind: linux
      mgmt-ipv4: 172.100.100.11
      image: image-tracker
      env:
        NUMBER_OF_TOTAL_PEERS: 21
      exec:
        - sleep 5
      cmd: "java -cp /app TrackerPeer"
      ports:
        - "5050:5050"

    lectureStudioServer:
      kind: linux
      mgmt-ipv4: 172.100.100.12
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: lectureStudioServer
        TARGET_PEERS: 1,2,3,5,16,6,18,8,9,10
        CONNECTION_9: eth9:172.20.29.2, 9:172.20.29.3
        CONNECTION_10: eth10:172.20.30.2, 10:172.20.30.3
        CONNECTION_8: eth8:172.20.28.2, 8:172.20.28.3
        CONNECTION_7: eth7:172.20.27.2, 18:172.20.27.3
        CONNECTION_6: eth6:172.20.26.2, 6:172.20.26.3
        CONNECTION_5: eth5:172.20.25.2, 16:172.20.25.3
        CONNECTION_4: eth4:172.20.24.2, 5:172.20.24.3
        CONNECTION_3: eth3:172.20.23.2, 3:172.20.23.3
        CONNECTION_2: eth2:172.20.22.2, 2:172.20.22.3
        CONNECTION_1: eth1:172.20.21.2, 1:172.20.21.3
        MAIN_CLASS: LectureStudioServer
      labels:
        role: sender
        group: server
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-tests/mydocument.pdf:/app/mydocument.pdf
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
      ports:
        - "7070:7070"

    11:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 11
        IP_ADDRES: 172.20.36.3
        SUPER_PEER: 9
        SUPER_PEER_IP_ADDRES: 172.20.36.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    12:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 12
        IP_ADDRES: 172.20.37.3
        SUPER_PEER: 10
        SUPER_PEER_IP_ADDRES: 172.20.37.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    13:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 13
        IP_ADDRES: 172.20.35.3
        SUPER_PEER: 8
        SUPER_PEER_IP_ADDRES: 172.20.35.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    14:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 14
        IP_ADDRES: 172.20.38.3
        SUPER_PEER: 10
        SUPER_PEER_IP_ADDRES: 172.20.38.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    15:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 15
        IP_ADDRES: 172.20.39.3
        SUPER_PEER: 10
        SUPER_PEER_IP_ADDRES: 172.20.39.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    16:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 16
        IP_ADDRES: 172.20.25.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.25.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    17:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 17
        IP_ADDRES: 172.20.40.3
        SUPER_PEER: 10
        SUPER_PEER_IP_ADDRES: 172.20.40.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    18:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 18
        IP_ADDRES: 172.20.27.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.27.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    19:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 19
        IP_ADDRES: 172.20.32.3
        SUPER_PEER: 1
        SUPER_PEER_IP_ADDRES: 172.20.32.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    1:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        IP_ADDRES: 172.20.21.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.21.2
        SOURCE_PEER: 1
        TARGET_PEERS: 4,19
        CONNECTION_11: eth2:172.20.31.2, 4:172.20.31.3
        CONNECTION_12: eth3:172.20.32.2, 19:172.20.32.3
        MAIN_CLASS: SuperPeer
      labels:
        role: receiver/sender
        group: superpeer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
    2:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 2
        IP_ADDRES: 172.20.22.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.22.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    3:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 3
        IP_ADDRES: 172.20.23.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.23.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    4:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 4
        IP_ADDRES: 172.20.31.3
        SUPER_PEER: 1
        SUPER_PEER_IP_ADDRES: 172.20.31.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    5:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 5
        IP_ADDRES: 172.20.24.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.24.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    6:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        IP_ADDRES: 172.20.26.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.26.2
        SOURCE_PEER: 6
        TARGET_PEERS: 7,20
        CONNECTION_13: eth2:172.20.33.2, 7:172.20.33.3
        CONNECTION_14: eth3:172.20.34.2, 20:172.20.34.3
        MAIN_CLASS: SuperPeer
      labels:
        role: receiver/sender
        group: superpeer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
    7:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 7
        IP_ADDRES: 172.20.33.3
        SUPER_PEER: 6
        SUPER_PEER_IP_ADDRES: 172.20.33.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    8:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        IP_ADDRES: 172.20.28.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.28.2
        SOURCE_PEER: 8
        TARGET_PEERS: 13
        CONNECTION_15: eth2:172.20.35.2, 13:172.20.35.3
        MAIN_CLASS: SuperPeer
      labels:
        role: receiver/sender
        group: superpeer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
    9:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        IP_ADDRES: 172.20.29.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.29.2
        SOURCE_PEER: 9
        TARGET_PEERS: 11
        CONNECTION_16: eth2:172.20.36.2, 11:172.20.36.3
        MAIN_CLASS: SuperPeer
      labels:
        role: receiver/sender
        group: superpeer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
    20:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        SOURCE_PEER: 20
        IP_ADDRES: 172.20.34.3
        SUPER_PEER: 6
        SUPER_PEER_IP_ADDRES: 172.20.34.2
        MAIN_CLASS: Peer
      labels:
        role: receiver
        group: peer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-peer.sh:/app/connection-details-peer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-peer.sh
        - ./connection-details-peer.sh
    10:
      kind: linux
      image: image-testbed
      env:
        NUMBER_OF_TOTAL_PEERS: 21
        PREFIX_NAME_OF_CONTAINER: p2p-containerlab-topology
        IP_ADDRES: 172.20.30.3
        SUPER_PEER: lectureStudioServer
        SUPER_PEER_IP_ADDRES: 172.20.30.2
        SOURCE_PEER: 10
        TARGET_PEERS: 12,14,15,17
        CONNECTION_17: eth2:172.20.37.2, 12:172.20.37.3
        CONNECTION_18: eth3:172.20.38.2, 14:172.20.38.3
        CONNECTION_19: eth4:172.20.39.2, 15:172.20.39.3
        CONNECTION_20: eth5:172.20.40.2, 17:172.20.40.3
        MAIN_CLASS: SuperPeer
      labels:
        role: receiver/sender
        group: superpeer
      binds:
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/connection-details/with-superpeer/connection-details-20.json:/app/connection-details-20.json
        - /home/ozcankaraca/Desktop/master-thesis-ozcankaraca/data-for-testbed/data-for-connection/script-for-connection/connection-details-superpeer.sh:/app/connection-details-superpeer.sh
      exec:
        - sleep 5
        - /bin/sh -c 'while ! ping -c 1 172.100.100.12 > /dev/null; do echo "Waiting for lectureStudioServer"; sleep 1; done'
        - chmod +x /app/connection-details-superpeer.sh
        - ./connection-details-superpeer.sh
  links:
    - endpoints: [lectureStudioServer:eth1, 1:eth1]
    - endpoints: [lectureStudioServer:eth2, 2:eth1]
    - endpoints: [lectureStudioServer:eth3, 3:eth1]
    - endpoints: [lectureStudioServer:eth4, 5:eth1]
    - endpoints: [lectureStudioServer:eth5, 16:eth1]
    - endpoints: [lectureStudioServer:eth6, 6:eth1]
    - endpoints: [lectureStudioServer:eth7, 18:eth1]
    - endpoints: [lectureStudioServer:eth8, 8:eth1]
    - endpoints: [lectureStudioServer:eth9, 9:eth1]
    - endpoints: [lectureStudioServer:eth10, 10:eth1]
    - endpoints: [1:eth2, 4:eth1]
    - endpoints: [1:eth3, 19:eth1]
    - endpoints: [6:eth2, 7:eth1]
    - endpoints: [6:eth3, 20:eth1]
    - endpoints: [8:eth2, 13:eth1]
    - endpoints: [9:eth2, 11:eth1]
    - endpoints: [10:eth2, 12:eth1]
    - endpoints: [10:eth3, 14:eth1]
    - endpoints: [10:eth4, 15:eth1]
    - endpoints: [10:eth5, 17:eth1]
